---
tags: [知识点记录, CSAPP]
---



## Intel 处理器历史和架构



ARM：

（参考[ARM64指的是什么？与x86什么区别？ - 知乎](https://zhuanlan.zhihu.com/p/508557771) ）

- ARM64 现在一般指 ARMv8 是ARM 公司发布的第一代支持64位处理器的指令集和体系结构
- ARM 一般作为 RISC 的代名词，是现在很多处理器的基础，一般是作为 IP 的一个销售商
- 和 ARM 相对的是 X86 架构，也就是CISC



## 编程语言

> C语言、汇编语言、机器语言

一些定义：

- Architecture / ISA：（指令）体系架构，如指令集规范、寄存器的设置
- 微结构：ISA的具体实现，如CACHE的设置和核心的频率
- 代码形式
  - 机器代码
  - 汇编代码



编译系统：

![image-20230111101447808](https://s2.loli.net/2023/01/11/hWAVeZFTojbfJC7.png)



机器级程序员可见的部分：

![](https://photo.sibnet.ru/upload/imggreat/1673059532831477855.jpg)



编译成汇编代码：

- `gcc -Og -S sample.c` 进行可读性优化编译，并在汇编代码处 Stop 编译
- 以 `.` 开头的汇编代码是一些给调试器提供信息定位的一些附带信息，可以完全忽略
- datalab  鲨鱼机？



汇编语言的特征：

- 数据类型
  - 整形：数值、地址
  - 浮点数
  - 由指令编译出的代码
  - 无数据结构
    - 机器级编程无法实现
    - 由编译器人工构造
    - 主要是在内存中连续分配
- 操作：单个的指令在能做到的事情上非常有限
  - 对内存和寄存器数据进行算数运算
  - 内存和寄存器之间的数据传输
  - 传输控制：跳转、分支



反汇编：

- 反汇编程序不会访问源代码和汇编代码，是直接根据可执行的二进制代码得出的
- 任何程序都可以解释为可执行的代码，汇编器检查二进制代码并重构它们



### 汇编基础

寄存器：

- 寄存器 e(extented) 版本比 r版本更大
- 现在除了基址寄存器 `%rbp` 和栈指针寄存器 `%rsp` ，其他都是通用寄存器，名字是历史遗留问题

移动数据：

- 操作数类型：立即数（用 `$` 开头）、寄存器、内存

- 操作数结合使用

  ![](https://photo.sibnet.ru/upload/imggreat/1673331940171477855.jpg)

- `movq D(R1), R2`

  - q (quad) 四字 64 bit Intel 以前一字是 16 bit

    - 类似的还有 b\w\l\s (byte\word\double word)
    - rax eax ax al 分别从长到短对不同寄存器的数位进行操作

  - 表示 `R1` 基址偏移 `D` 个位置 `Mem[Reg(R) + D]` 寻址

  - 更一般的地址计算形式：立即数 + 基址 + 比例因子 \* 变址

    ![image-20230110210247994](https://s2.loli.net/2023/01/10/NzLKbtuEiPAoqGa.png)

- 调用者保存与被调用者保存，在调用函数或者被调用函数的开头结束存储恢复局部代码的值

- 栈操作
  ![](https://cdn.nlark.com/yuque/0/2023/png/12681739/1673405531665-9790521b-2bd1-43c7-9879-14e7c27b88be.png?x-oss-process=image%2Fresize%2Cw_1327%2Climit_0)

  - 栈从高地址往低地址延展

  - 栈指令可以等效成更长的两个指令

- `leaq` 基本类似于 `moveq` ，功能是加载

- 编译器会不断寻找各种更聪明的汇编方法来实现高级语言



